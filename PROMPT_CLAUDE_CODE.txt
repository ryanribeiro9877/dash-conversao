PROMPT PARA CLAUDE CODE - DASHBOARD DE CONVERSÃƒO LEGAL Ã‰ VIVER

Crie um sistema completo de Dashboard de ConversÃ£o para leads em etapa "Assinatura".

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STACK TECNOLÃ“GICO:

Backend:
- Node.js 18+ com TypeScript
- Express.js (API REST)
- MongoDB (database)
- Redis (cache e filas)
- BullMQ (processamento assÃ­ncrono)
- Winston (logging)
- Joi (validaÃ§Ã£o)
- Axios (HTTP client)

Frontend:
- React 18+ com TypeScript
- Vite (build tool)
- TailwindCSS (estilizaÃ§Ã£o)
- React Query (state management)
- Recharts (grÃ¡ficos)
- React Router (navegaÃ§Ã£o)
- date-fns (manipulaÃ§Ã£o de datas)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ESTRUTURA DO PROJETO:

dashboard-conversao-legal-viver/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ Lead.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ WhatsAppConnection.ts
â”‚   â”‚   â”‚   â””â”€â”€ MessageTemplate.ts
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ LeadService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ IACallService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ WhatsAppService.ts
â”‚   â”‚   â”‚   â””â”€â”€ MarketingEnginesService.ts
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â”œâ”€â”€ LeadController.ts
â”‚   â”‚   â”‚   â””â”€â”€ WebhookController.ts
â”‚   â”‚   â”œâ”€â”€ queues/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ workers/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ database.ts
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â””â”€â”€ logger.ts
â”‚   â”‚   â””â”€â”€ server.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ .env.example
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ LeadCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LeadDetails.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Timeline.tsx
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LeadList.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Analytics.tsx
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â””â”€â”€ useLeads.ts
â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ App.tsx
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â”œâ”€â”€ postcss.config.js
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ README.md
â””â”€â”€ DOCUMENTACAO.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MODELOS DE DADOS:

1. Lead (MongoDB Model):
   - lead_id: string (UUID)
   - cpf: string
   - nome_completo: string
   - telefones: Array<{
       numero: string
       prioridade: number (1=LP, 2+=enriquecido)
       origem: string
       inapto: boolean
       motivo_inapto: string
     }>
   - emails: Array<{ email: string, origem: string }>
   - proposta: {
       id_proposta: string
       data_criacao_proposta: Date
       valor_liberado: number
       prazo_meses: number
       valor_parcela: number
       banco: string
       link_assinatura_atual: string
       data_geracao_link_assinatura: Date
       status_proposta: enum (PENDENTE, PAGO, PENDENCIA, EXPIRADA)
     }
   - status_atual: enum (ROXO, AZUL, VERDE, VERMELHO, LARANJA, BRANCO, REPROVADO)
   - historico_status: Array<{ status, timestamp, motivo }>
   - historico_interacoes: Array<{ tipo, dados, timestamp, custo }>
   - custos: { custo_aquisicao, custo_motores, custo_total, detalhamento }
   - atribuicao_whatsapp: { conexao_id, numero_wa, status_conexao, novas_conversas_hoje, data_atribuicao }
   - agendamentos: Array<{ data_hora, motivo, operador, concluido }>
   - observacoes: Array<{ texto, operador, timestamp }>
   - humano_obrigatorio: boolean
   - pausar_automacoes: boolean
   - origem: string
   - data_entrada_assinatura: Date

2. WhatsAppConnection:
   - conexao_id: string
   - numero_wa: string
   - nome_conexao: string
   - status: enum (ATIVA, BANIDA, OFFLINE, MANUTENCAO)
   - novas_conversas_hoje: number
   - limite_diario: number (default 25)
   - ultima_mensagem: Date
   - metadata: object

3. MessageTemplate:
   - contexto: enum (WHATSAPP_INICIAL, WHATSAPP_CUTUCADA_MENOS_3_DIAS, etc)
   - titulo: string
   - conteudo: string
   - variaveis: string[] (ex: ['nome_completo', 'valor_liberado'])
   - ativo: boolean
   - prioridade: number (1-10)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SISTEMA DE CORES (STATUS):

ğŸŸ£ ROXO = PAGO
   - Gatilho: Consulta retornou PAGO
   - AÃ§Ã£o: Encerra ciclo, envia parabÃ©ns (RCS+Email+IA), pausa automaÃ§Ãµes

ğŸ”µ AZUL = PENDÃŠNCIA
   - Gatilho: Assinou + retornou pendÃªncia
   - AÃ§Ã£o: Requer correÃ§Ã£o humana com SLA alto

ğŸŸ¢ VERDE = INTERAGIU
   - Gatilho: Digitou 1, clicou em link, mensagem com dÃºvida (nÃ£o reclamaÃ§Ã£o)
   - AÃ§Ã£o: Demonstrou interesse, continua fluxo

ğŸ”´ VERMELHO = RECLAMAÃ‡ÃƒO
   - Gatilho: Detectou reclamaÃ§Ã£o/raiva via palavras-chave ou sentimento negativo
   - AÃ§Ã£o: Pausa automaÃ§Ãµes, humano_obrigatorio=true, prioridade mÃ¡xima

ğŸŸ  LARANJA = SEM INTERAÃ‡ÃƒO
   - Gatilho: Completou ciclo automÃ¡tico sem nenhuma interaÃ§Ã£o
   - AÃ§Ã£o: BLOQUEIA WhatsApp manual do operador

âšª BRANCO = EXPIRADA
   - Gatilho: Proposta/link expirou (30+ dias)
   - AÃ§Ã£o: Encerra ciclo, registra motivo

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

REGRAS IA DE LIGAÃ‡ÃƒO (IACallService.ts):

PRIORIZAÃ‡ÃƒO:
1. Lista A (prioridade=1, informado na LP)
2. Lista B (prioridade>=2, enriquecidos)

TENTATIVAS:
- MÃ¡ximo: 6 tentativas por lead
- Janelas: 08:00, 12:00, 19:00
- Distribui tentativas entre nÃºmeros e janelas

RESULTADOS E AÃ‡Ã•ES:

A) NÃƒO_ATENDEU ou DERRUBOU (nÃºmero vÃ¡lido):
   - Religar em 5 minutos (mesmo nÃºmero)
   - Se falhar: religar em 10 minutos
   - Se falhar: religar em 20 minutos
   - ApÃ³s sequÃªncia: prÃ³ximo nÃºmero ou prÃ³xima janela

B) CAIXA_POSTAL, INVALIDO, INEXISTENTE:
   - Marcar telefone como inapto (permanente)
   - Pular imediatamente para prÃ³ximo telefone
   - NÃƒO aplicar religaÃ§Ã£o 5/10/20

C) ATENDEU_DIGITOU_1:
   - Encerrar tentativas pendentes de IA
   - Status â†’ VERDE (se nÃ£o PAGO/PENDÃŠNCIA)
   - Disparar webhook WhatsApp com trigger_source=IA_LIGACAO_DIGITOU_1

D) ATENDEU_SEM_ACAO:
   - Registrar ATENDEU_SEM_ACAO
   - Aplicar religaÃ§Ã£o 5/10/20 com prompts de reforÃ§o
   - Continua cadÃªncia se persistir

E) PEDIU_OPERADOR:
   - humano_obrigatorio = true
   - Criar alerta prioritÃ¡rio
   - Pausar automaÃ§Ãµes (opcional)

TEMPLATES RANDÃ”MICOS:
- Biblioteca de variaÃ§Ãµes por janela (JANELA_1, JANELA_2, JANELA_3)
- SeleÃ§Ã£o ponderada por prioridade
- SubstituiÃ§Ã£o de variÃ¡veis: {{nome_completo}}, {{valor_liberado}}, etc

CUSTOS:
- Registrar custo por tentativa (env: COST_IA_CALL)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

REGRAS WHATSAPP (WhatsAppService.ts):

POOL DE CONEXÃ•ES:
- 20 conexÃµes ativas
- Limite: 25 novas conversas/dia por conexÃ£o
- Reset automÃ¡tico diÃ¡rio Ã s 00:00 (CRON job)

ATRIBUIÃ‡ÃƒO (ROLETA):

1. NOVO (lead sem conversa):
   - Buscar prÃ³xima conexÃ£o disponÃ­vel (status=ATIVA, conversas<25)
   - Ordenar por: menor nÃºmero de conversas, Ãºltima mensagem mais antiga
   - Atribuir e incrementar contador
   - Tipo: "NOVO"

2. RETENÃ‡ÃƒO (lead jÃ¡ tem conversa):
   - Verificar status da conexÃ£o antiga
   - Se ATIVA: manter mesma conexÃ£o
   - Tipo: "RETENCAO"

3. FAILOVER (conexÃ£o banida/offline):
   - Se conexÃ£o antiga estÃ¡ BANIDA ou OFFLINE
   - Reatribuir via roleta (prÃ³xima disponÃ­vel)
   - Tipo: "FAILOVER"

REGRA DO LINK (3 DIAS):

- Calcular: dias desde data_geracao_link_assinatura
- SE < 3 dias:
    * NÃƒO reenviar link
    * Enviar cutucada: "sua proposta estÃ¡ acima, ficou alguma dÃºvida?"
- SE >= 3 dias:
    * Gerar novo link via API
    * Atualizar data_geracao_link_assinatura
    * Enviar link novo

MENSAGENS RANDÃ”MICAS:
- Contextos: WHATSAPP_INICIAL, WHATSAPP_CUTUCADA_MENOS_3_DIAS, WHATSAPP_CUTUCADA_MAIS_3_DIAS, WHATSAPP_REATIVACAO
- SeleÃ§Ã£o aleatÃ³ria ponderada
- SubstituiÃ§Ã£o de variÃ¡veis

CUSTOS:
- Registrar custo por mensagem (env: COST_WHATSAPP_MESSAGE)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MOTORES MARKETING (MarketingEnginesService.ts):

RCS:
- Enviar com link rastreÃ¡vel Ãºnico: link?utm_source=rcs&lead_id=X
- Eventos: ENVIADO, ENTREGUE, ABERTO, CLICADO
- Custo: env COST_RCS

SMS (fallback do RCS):
- Enviar com link rastreÃ¡vel: link?utm_source=sms&lead_id=X
- Eventos: ENVIADO, ENTREGUE, CLICADO
- Custo: env COST_SMS

EMAIL:
- Contextos: EMAIL_INICIAL, EMAIL_PARABENS_PAGO
- Link rastreÃ¡vel: link?utm_source=email&lead_id=X
- Eventos: ENVIADO, ENTREGUE, ABERTO, CLICADO
- Custo: env COST_EMAIL

WEBHOOKS:
- Ao receber evento CLICADO de qualquer motor:
    * Atualizar status â†’ VERDE
    * Disparar WhatsAppService.processarGatilho(leadId, 'RCS_CLIQUE' ou 'SMS_CLIQUE' ou 'EMAIL_CLIQUE')

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

API REST (Express Routes):

LEADS:
POST   /api/leads/importar                # Importa lead etapa Assinatura
GET    /api/leads                         # Lista com filtros (status, origem, humano_obrigatorio, data_inicio, data_fim, pagina, limite)
GET    /api/leads/:leadId                 # Busca especÃ­fico
PUT    /api/leads/:leadId/status          # Atualiza status manualmente
POST   /api/leads/:leadId/agendamento     # Adiciona agendamento
POST   /api/leads/:leadId/observacao      # Adiciona observaÃ§Ã£o
GET    /api/leads/estatisticas            # EstatÃ­sticas por cor
GET    /api/leads/humano-obrigatorio      # Leads que requerem atenÃ§Ã£o

WEBHOOKS:
POST   /api/webhooks/conversion-trigger   # Gatilho digitou 1 / clique
       Body: { lead_id, cpf, trigger_source }

POST   /api/webhooks/rcs                  # Eventos RCS
       Body: { lead_id, campanha_id, event_type, timestamp }

POST   /api/webhooks/sms                  # Eventos SMS
       Body: { lead_id, campanha_id, event_type, timestamp }

POST   /api/webhooks/email                # Eventos Email
       Body: { lead_id, campanha_id, event_type, timestamp }

POST   /api/webhooks/proposal-status      # Status proposta
       Body: { lead_id, cpf, id_proposta, status, motivo }

HEALTH:
GET    /api/health                        # Health check

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FILAS BULLMQ (backend/src/queues/index.ts):

1. lead-import       # ImportaÃ§Ã£o de leads
2. ia-call           # Processamento ligaÃ§Ãµes IA
3. whatsapp          # Envio mensagens WhatsApp
4. rcs               # Envio RCS
5. sms               # Envio SMS
6. email             # Envio email
7. proposal-check    # VerificaÃ§Ã£o expiraÃ§Ã£o (CRON 6h)

ConfiguraÃ§Ã£o:
- Connection: IORedis
- Retry: 3 tentativas com backoff exponencial
- Remove on complete: 1000 jobs, 24h
- Remove on fail: 7 dias

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

WORKERS (backend/src/workers/index.ts):

1. iaCallWorker       # Processa fila ia-call
2. whatsappWorker     # Processa fila whatsapp + reset diÃ¡rio
3. rcsWorker          # Processa fila rcs
4. smsWorker          # Processa fila sms
5. emailWorker        # Processa fila email
6. proposalCheckWorker # Processa fila proposal-check (CRON)

JOBS RECORRENTES:
- Reset WhatsApp: CRON '0 0 * * *' (00:00 diÃ¡rio)
- Check Proposals: CRON '0 */6 * * *' (a cada 6h)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OPERAÃ‡ÃƒO HUMANA - BLOQUEIOS:

STATUS VERDE:
- Permitido: LigaÃ§Ã£o manual
- RecomendaÃ§Ã£o: Preferir ligaÃ§Ã£o, evitar WhatsApp manual

STATUS VERMELHO:
- Prioridade: MÃXIMA
- AÃ§Ã£o: Pausar automaÃ§Ãµes para nÃ£o piorar experiÃªncia
- Permitido: Toda intervenÃ§Ã£o humana

STATUS LARANJA:
- BLOQUEIO TOTAL: WhatsApp manual (UI e API bloqueiam)
- Permitido: Ver histÃ³rico, agendar, observaÃ§Ãµes
- RazÃ£o: Lead nÃ£o interagiu, spam pode piorar

STATUS AZUL:
- AÃ§Ã£o: CorreÃ§Ã£o de pendÃªncia obrigatÃ³ria
- SLA: Alto
- ApÃ³s correÃ§Ã£o: Reconsultar atÃ© resolver

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GESTÃƒO DE CUSTOS:

Por Lead:
- custo_aquisicao: Custo do canal origem (Meta, TikTok, URA, WhatsApp)
- custo_motores: Soma de todas as aÃ§Ãµes (IA, RCS, SMS, Email, WhatsApp)
- custo_total: custo_aquisicao + custo_motores
- detalhamento: Array com { motor, acao, custo, timestamp }

Subdashboards AnalÃ­ticos:
1. Custos: Custo por conversÃ£o, custo por motor, ROI por canal
2. Motores: Taxa sucesso IA, entregabilidade, cliques, conversÃµes
3. Tempo: Tempo por cor, funil Assinaturaâ†’Coresâ†’Encerramento
4. Qualidade: Taxa reclamaÃ§Ã£o, expiraÃ§Ã£o, pendÃªncia

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENCERRAMENTO DE CICLO:

PAGO (ROXO):
- Receber evento via webhook/consulta
- Status â†’ ROXO
- Pausar automaÃ§Ãµes conversÃ£o
- Disparar: RCS parabÃ©ns + Email parabÃ©ns + IA ligaÃ§Ã£o parabÃ©ns
- Mover para histÃ³rico/filtro

PENDÃŠNCIA (AZUL):
- Receber evento pendÃªncia pÃ³s-assinatura
- Status â†’ AZUL
- Registrar motivo
- Gerar alerta correÃ§Ã£o
- Operador executa correÃ§Ã£o
- Sistema reconsulta atÃ© resolver
- Se resolver: ROXO | Se expirar: BRANCO

EXPIRADA (BRANCO):
- Detectar expiraÃ§Ã£o link/proposta (30+ dias)
- Status â†’ BRANCO
- Encerrar ciclo automÃ¡tico
- Registrar motivo e evidÃªncias

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FLUXO REPROVADOS (separado):

DETECÃ‡ÃƒO:
- Status = REPROVADO (do sistema original)

AÃ‡ÃƒO:
1. Enviar RCS (ou SMS fallback): "Infelizmente sua proposta foi reprovada. Faremos nova anÃ¡lise em 30 dias."
2. Criar agendamento interno: reavaliaÃ§Ã£o em 30 dias
3. ApÃ³s 30 dias: nova anÃ¡lise
   - Se aprovado: entra no dash conversÃ£o normalmente
   - Se reprovado: repetir ciclo

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FRONTEND (React + TypeScript):

COMPONENTES PRINCIPAIS:

1. Dashboard.tsx (Kanban por cor):
   - Colunas: ROXO, AZUL, VERDE, VERMELHO, LARANJA, BRANCO
   - Contadores por status
   - Cards arrastÃ¡veis
   - Filtros: origem, data, operador

2. LeadCard.tsx:
   - Nome, CPF, status (cor)
   - Valor proposta, parcelas
   - Ãšltima interaÃ§Ã£o (relativa)
   - Custos totais
   - BotÃ£o "Ver Detalhes"

3. LeadDetails.tsx (Modal/PÃ¡gina):
   - Dados completos lead
   - Proposta detalhada
   - Contatos (telefones prioridade, emails)
   - Linha do tempo completa (Timeline.tsx)
   - Custos detalhados
   - AÃ§Ãµes: Ligar, Agendar, ObservaÃ§Ã£o
   - Bloqueios por status (LARANJA nÃ£o tem WhatsApp)

4. Timeline.tsx:
   - Eventos ordenados cronologicamente
   - Ãcones por tipo (telefone, email, WhatsApp, status)
   - Detalhes expandÃ­veis
   - Custos por aÃ§Ã£o

5. Analytics.tsx:
   - GrÃ¡ficos Recharts: Pizza (por cor), Barras (conversÃµes), Linha (tempo mÃ©dio)
   - Cards KPI: taxa conversÃ£o, custo mÃ©dio, ROI
   - Filtros temporais

HOOKS:
- useLeads: React Query para buscar/atualizar leads
- useDashboard: EstatÃ­sticas e filtros
- useWebSocket: Updates real-time (opcional)

SERVICES:
- api.ts: Axios configurado com base URL, interceptors, tipos

STYLING:
- TailwindCSS com cores customizadas para status
- Responsivo (mobile-first)
- Dark mode (opcional)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CONFIGURAÃ‡Ã•ES AMBIENTE (.env.example):

# MongoDB
MONGODB_URI=mongodb://localhost:27017/dashboard_conversao

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# Server
PORT=3000
NODE_ENV=development

# WhatsApp
WHATSAPP_CONNECTIONS_COUNT=20
WHATSAPP_DAILY_LIMIT_PER_CONNECTION=25
WHATSAPP_API_URL=https://api.whatsapp.com
WHATSAPP_API_KEY=

# External APIs
IA_CALL_API_URL=https://api.ia-ligacao.com
IA_CALL_API_KEY=

RCS_API_URL=https://api.rcs.com
RCS_API_KEY=

SMS_API_URL=https://api.sms.com
SMS_API_KEY=

EMAIL_API_URL=https://api.email.com
EMAIL_API_KEY=

# Dashboard Original
ORIGINAL_DASHBOARD_URL=https://dash-clt.legalivv.com.br
ORIGINAL_DASHBOARD_API_KEY=

# Costs (centavos)
COST_IA_CALL=50
COST_RCS=15
COST_SMS=10
COST_EMAIL=5
COST_WHATSAPP_MESSAGE=5

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

REQUISITOS NÃƒO-FUNCIONAIS:

CÃ“DIGO:
- TypeScript estrito (strict: true)
- ESLint + Prettier configurados
- ComentÃ¡rios inline explicativos
- Tratamento de erros robusto
- ValidaÃ§Ã£o de entrada (Joi)

SEGURANÃ‡A:
- Rate limiting (100 req/15min)
- Helmet.js headers
- CORS configurado
- VariÃ¡veis ambiente (.env)
- SanitizaÃ§Ã£o de dados

PERFORMANCE:
- Ãndices MongoDB otimizados
- Cache Redis quando aplicÃ¡vel
- PaginaÃ§Ã£o em listagens
- Lazy loading frontend

LOGS:
- Winston logger
- NÃ­veis: error, warn, info, debug
- Arquivos separados: error.log, combined.log
- Logs estruturados (JSON)

MONITORAMENTO:
- Health check endpoint
- MÃ©tricas por motor
- Rastreabilidade total

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INSTRUÃ‡Ã•ES ESPECIAIS:

1. PRIORIZE FIDELIDADE Ã€ ESPECIFICAÃ‡ÃƒO
   - Cada regra listada acima DEVE ser implementada exatamente
   - NÃ£o simplifique nem omita regras

2. CÃ“DIGO PROFISSIONAL
   - Use padrÃµes de design (Service, Controller, Repository)
   - SeparaÃ§Ã£o de responsabilidades
   - DRY (Don't Repeat Yourself)
   - Clean Code principles

3. DOCUMENTAÃ‡ÃƒO
   - README.md completo em cada pasta
   - ComentÃ¡rios inline em lÃ³gicas complexas
   - JSDoc para funÃ§Ãµes pÃºblicas
   - Exemplos de uso nas APIs

4. TESTES (opcional mas recomendado)
   - Jest para backend
   - React Testing Library para frontend
   - Cobertura mÃ­nima 70%

5. DOCKER (opcional)
   - docker-compose.yml para MongoDB + Redis
   - Dockerfile para backend e frontend

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENTREGÃVEIS:

âœ… Estrutura de diretÃ³rios completa
âœ… Todos os arquivos TypeScript com cÃ³digo funcional
âœ… package.json com todas as dependÃªncias
âœ… tsconfig.json configurado
âœ… .env.example com todas as variÃ¡veis
âœ… README.md principal com instruÃ§Ãµes de instalaÃ§Ã£o
âœ… README.md em backend/ e frontend/
âœ… DOCUMENTACAO.md tÃ©cnica completa

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

IMPORTANTE:

Este Ã© um sistema de conversÃ£o de leads de alta complexidade.
Cada regra foi especificada apÃ³s anÃ¡lise detalhada.
O sucesso do sistema depende da fidelidade Ã  implementaÃ§Ã£o.

IMPLEMENTE TUDO COM MÃXIMA QUALIDADE E ATENÃ‡ÃƒO AOS DETALHES!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
